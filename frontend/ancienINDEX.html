<!DOCTYPE html>
<html lang="en">
  <head>
     <!--affichage du titre + logo dans l'onglet de la page-->
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Pokémon TCG</title>
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <!--Navigation Bar => logo à gauche et menu à droite -->
    <nav class="navbar">
      <img src="./public/pokemon.png" alt="Image Pokemon" class="logo" />
      <div class="nav-links">
        <ul>
          <li><a href="index.html">COLLECTION</a></li>
          <li><a href="#">MYPOKEMON</a></li>
        </ul>
      </div>
      <!-- Menu qui est responsive -->
      <img src="./public/menu_hamburger.png" alt="menu hamburger" class="menu-hamburger"></img>
    </nav>
    <!-- recherche classique avec bouton -->
    <div class="recherche">
      <form id="search-form">
        <input
          type="text"
          id="search-input"
          placeholder="Rechercher par type..."
        />
        <button type="submit">Rechercher</button>
      </form>
      <button id="cancelSearchButton" style="display: none;">Annuler la recherche</button>
    </div>
    <div id="content" class="card-container"></div>
    <!-- Les cartes sont affichées ici -->
    <div class="boutonPage">
      <button id="showImageButton">Afficher 10 cartes supplémentaires</button>
    </div>
    <div id="search-results" class="card-container-recherche">
      <!-- Les résultats de la recherche seront affichés ici -->
    </div>
    <div id="root"></div>

    
<script type="module">
    
  const menuHamburger = document.querySelector('.menu-hamburger');
  const navLinks = document.querySelector('.nav-links');
  let currentCardIndex = 0;
  const cardsPerPage = 10;
  let cardData = [];
  let searchResultsVisible = false; 

  menuHamburger.addEventListener('click', () => {
    navLinks.classList.toggle('mobile-menu');
  });

  /* gestionnaire pour l'annulation de recherche */
  const cancelSearchButton = document.getElementById('cancelSearchButton');

  cancelSearchButton.addEventListener('click', () => {
    const searchResults = document.getElementById('search-results');
    const content = document.getElementById('content');

    // Réinitialisez l'affichage en cachant les résultats de recherche et en réaffichant le contenu principal
    searchResults.style.display = 'none';
    content.style.display = 'block';
    cancelSearchButton.style.display = 'none';
  });

  let cards = [] // Stocker les données des cartes chargées depuis le fichier ToutesCartes.json

  
  fetch('ToutesCartes.json')
    .then(response => response.json())
    .then(data => {
      cards = data;

      
      document
        .getElementById('search-form')
        .addEventListener('submit', function (e) {
          e.preventDefault(); // Empêche la soumission du formulaire par défaut

          const searchInput = document.getElementById('search-input').value; 

          const searchResults = document.getElementById('search-results');
          const content = document.getElementById('content');

          // Réalisez la recherche en filtrant les cartes par type
          const filteredCards = cards.filter(card => {
            return card.types.includes(searchInput);
          });

          // Affichez les résultats de la recherche
          displaySearchResults(filteredCards, searchResults);

          cancelSearchButton.style.display = 'block';
          // Masquez le contenu précédent
          content.style.display = 'none';
          searchResultsVisible = true;
        });
    })
    .catch(error => {
      console.error('Erreur de chargement des données :', error);
    });

  // Fonction pour afficher les résultats de la recherche
  function displaySearchResults(results, element) {
    element.innerHTML = ''; // Efface les résultats précédents

    if (results.length === 0) {
      element.innerHTML = '<p>Aucun résultat trouvé.</p>';
      return;
    }

    results.forEach(card => {
      const cardDiv = document.createElement('div');
      cardDiv.className = 'img-container-recherche';

      const cardImage = document.createElement('img');
      cardImage.src = card.images.small;

      cardDiv.appendChild(cardImage);
      element.appendChild(cardDiv);
    });
  }
